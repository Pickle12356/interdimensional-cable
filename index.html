<iframe id="videoPlayer" width="560" height="315" frameborder="0" allowfullscreen></iframe>
<button id="nextBtn">Next Channel ðŸ“º</button>

<script>
let current = 0;
let videos = [];

document.getElementById("nextBtn").onclick = () => {
  showStaticThenNext();
};

async function fetchVideos() {
  const res = await fetch("/api/fetchVideos");
  const data = await res.json();
  videos = data.videos.filter(v => v.videoId); // Ensure valid IDs
  showNext();
}

function showStaticThenNext() {
  const iframe = document.getElementById("videoPlayer");
  iframe.src = "static-glitch.gif"; // show a glitch effect
  setTimeout(showNext, 500); // 0.5s glitch
}

function showNext() {
  if (!videos.length) return;
  current = (current + 1) % videos.length;
  const video = videos[current];
  document.getElementById("videoPlayer").src =
    `https://www.youtube.com/embed/${video.videoId}?autoplay=1`;
}

fetchVideos();
</script>
